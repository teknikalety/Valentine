<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Valentines Day</title>
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    .gradient-background {
      background: linear-gradient(
        180deg,
        rgba(255,208,229,1) 0%,
        rgba(255,232,242,1) 36%,
        rgba(255,255,255,1) 100%
      );
      transition: background 2s ease;
    }

    .big-yes-bg {
      background: #22c55e;
      cursor: pointer;
    }

    .big-yes-bg::after {
      content: "YES ðŸ’–";
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20vw;
      font-weight: 900;
      color: rgba(255,255,255,0.35);
      pointer-events: none;
    }

    button {
      transition: all 0.25s ease;
    }
  </style>
</head>

<body class="gradient-background" id="body">
  <div class="flex items-center justify-center h-screen">
    <div class="flex flex-col items-center text-center p-4">

      <img id="imageDisplay" src="./images/image1.gif" class="rounded-md h-[300px]" />

      <h2 id="valentineQuestion" class="text-4xl font-bold italic text-[#bd1e59] my-4">
        Will you be my Valentine Mooncake? ðŸ¥ºðŸ‘‰ðŸ‘ˆ
      </h2>

      <div class="flex gap-4 pt-5 items-center" id="responseButtons">
        <button id="yesButton"
          class="bg-green-500 hover:bg-green-400 text-white rounded-md text-xl px-4 py-2">
          Yes
        </button>

        <button id="noButton"
          class="bg-red-500 hover:bg-red-700 text-white rounded-md text-xl px-4 py-2">
          No
        </button>
      </div>
    </div>
  </div>

  <script type="module">
    import confetti from "https://cdn.skypack.dev/canvas-confetti";

    const body = document.getElementById("body");
    const yesButton = document.getElementById("yesButton");
    const noButton = document.getElementById("noButton");
    const responseButtons = document.getElementById("responseButtons");
    const imageDisplay = document.getElementById("imageDisplay");
    const valentineQuestion = document.getElementById("valentineQuestion");

    let noClicks = 0;

    // YES chase tuning
    let chaseStrength = 0.00001;       // barely alive at start
    const MAX_CHASE = 0.002;           // final speed (what you liked)
    const MAX_NO_CLICKS = 7;           

    let mouseX = 0, mouseY = 0;
    let yesX = 0, yesY = 0;

    const images = [
      "./images/image1.gif",
      "./images/image2.gif",
      "./images/image3.gif",
      "./images/image4.gif",
      "./images/image5.gif",
      "./images/image6.gif",
      "./images/image7.gif"
    ];

    // Track mouse position
    document.addEventListener("mousemove", e => {
      mouseX = e.clientX;
      mouseY = e.clientY;
    });

    // YES button gently (then not-so-gently) chases cursor
    function chaseYes() {
      const rect = yesButton.getBoundingClientRect();
      yesX += (mouseX - rect.left - rect.width / 2) * chaseStrength;
      yesY += (mouseY - rect.top - rect.height / 2) * chaseStrength;
      yesButton.style.transform = `translate(${yesX}px, ${yesY}px)`;
      requestAnimationFrame(chaseYes);
    }
    chaseYes();

    // NO button starts evading
    function enableNoEvade() {
      noButton.addEventListener("mouseenter", () => {
        const x = Math.random() * (window.innerWidth - 120);
        const y = Math.random() * (window.innerHeight - 60);
        noButton.style.position = "fixed";
        noButton.style.left = `${x}px`;
        noButton.style.top = `${y}px`;
      });
    }

    noButton.addEventListener("click", () => {
      noClicks++;

      imageDisplay.src =
        images[Math.min(noClicks, images.length - 1)];

      // Progress from 0 â†’ 1
      const progress = Math.min(noClicks / MAX_NO_CLICKS, 1);

      // Exponent ramps from 2 â†’ 6
      const exponent = 2 + progress * 4;

      // Apply eased chase
      chaseStrength = MAX_CHASE * Math.pow(progress, exponent);

      if (noClicks === 5) enableNoEvade();

      if (noClicks >= 7) {
        body.classList.add("big-yes-bg");
        body.addEventListener("click", yesOutcome);
      }
    });

    function startConfettiEscalation() {
      let particles = 8;
      let spread = 25;

      const interval = setInterval(() => {
        confetti({
          particleCount: particles,
          spread: spread,
          origin: { y: 0.6 }
        });

        particles += 10;
        spread += 5;

        if (particles >= 300) {
          clearInterval(interval);
        }
      }, 1800); // ~2 minutes total
    }

    function yesOutcome() {
      body.className = "";
      body.removeEventListener("click", yesOutcome);

      responseButtons.remove();
      yesButton.remove();
      noButton.remove();

      imageDisplay.src = "./images/image7.gif";
      valentineQuestion.textContent =
        "Yayyy!! ðŸ’– You said yes ðŸ¥ºðŸ’— I'm the luckiest person ever.";

      startConfettiEscalation();

      setTimeout(() => {
        valentineQuestion.textContent =
          "I can't wait to be your Valentine, Mooncake ðŸ¥°";
      }, 5000);

      setTimeout(() => {
        valentineQuestion.textContent =
          "Now youâ€™re stuck with me ðŸ˜ŒðŸ’˜";
      }, 10000);
    }

    yesButton.addEventListener("click", yesOutcome);
  </script>
</body>
</html>
